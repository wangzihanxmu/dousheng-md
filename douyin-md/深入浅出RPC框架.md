# 深入浅出RPC框架

## 目录

- 01 关键概念
- 02 分层设计
- 03 关键指标
- 04 企业实践

## 01 基本概念

ubuntu下选择指定区域截屏并且放入剪贴板: shift + ctrl + prtsc

![image-20220527132149934](深入浅出RPC框架.assets/image-20220527132149934.png)

![image-20220527132346989](深入浅出RPC框架.assets/image-20220527132346989.png)

远程调用

- 不同进程,给函数绑定ID
- 不同进程,数据要转换成字节流
- 高校稳定传输数据

![image-20220527132612973](深入浅出RPC框架.assets/image-20220527132612973.png)

![image-20220527132734446](深入浅出RPC框架.assets/image-20220527132734446.png)

![image-20220527133202941](深入浅出RPC框架.assets/image-20220527133202941.png)

![image-20220527133411522](深入浅出RPC框架.assets/image-20220527133411522.png)

![image-20220527133457821](深入浅出RPC框架.assets/image-20220527133457821.png)

## 02 分层设计

![image-20220527133551602](深入浅出RPC框架.assets/image-20220527133551602.png)

![image-20220527133905611](深入浅出RPC框架.assets/image-20220527133905611.png)

![image-20220527133951158](深入浅出RPC框架.assets/image-20220527133951158.png)

![image-20220527134137641](深入浅出RPC框架.assets/image-20220527134137641.png)

![image-20220527134548280](深入浅出RPC框架.assets/image-20220527134548280.png)

![image-20220527134824988](深入浅出RPC框架.assets/image-20220527134824988.png)

![image-20220527134850042](深入浅出RPC框架.assets/image-20220527134850042.png)

![image-20220527135009594](深入浅出RPC框架.assets/image-20220527135009594.png)

![image-20220527135227789](深入浅出RPC框架.assets/image-20220527135227789.png)

![image-20220527135342394](深入浅出RPC框架.assets/image-20220527135342394.png)

![image-20220527135409390](深入浅出RPC框架.assets/image-20220527135409390.png)

![image-20220527135730979](深入浅出RPC框架.assets/image-20220527135730979.png)

![image-20220527135846123](深入浅出RPC框架.assets/image-20220527135846123.png)

## 03 关键指标

- 稳定性
- 易用性
- 扩展性
- 观测性
- 高性能

![image-20220527140026463](深入浅出RPC框架.assets/image-20220527140026463.png)

![image-20220527140238116](深入浅出RPC框架.assets/image-20220527140238116.png)

![image-20220527140450725](深入浅出RPC框架.assets/image-20220527140450725.png)

![image-20220527140844445](深入浅出RPC框架.assets/image-20220527140844445.png)

![image-20220527140940334](深入浅出RPC框架.assets/image-20220527140940334.png)

![image-20220527141151643](深入浅出RPC框架.assets/image-20220527141151643.png)

![image-20220527141334639](深入浅出RPC框架.assets/image-20220527141334639.png)

![image-20220527141604367](深入浅出RPC框架.assets/image-20220527141604367.png)

![image-20220527141910809](深入浅出RPC框架.assets/image-20220527141910809.png)

## 04 企业实践

- 整体架构
- 自研网络库
- 扩展性设计
- 性能优化
- 合并部署

![image-20220527142513164](深入浅出RPC框架.assets/image-20220527142513164.png)

![image-20220527144800298](深入浅出RPC框架.assets/image-20220527144800298.png)

![image-20220527144834960](深入浅出RPC框架.assets/image-20220527144834960.png)

![image-20220527144940511](深入浅出RPC框架.assets/image-20220527144940511.png)

![image-20220527145118421](深入浅出RPC框架.assets/image-20220527145118421.png)

![image-20220527145255919](深入浅出RPC框架.assets/image-20220527145255919.png)

![image-20220527145749703](深入浅出RPC框架.assets/image-20220527145749703.png)

![image-20220527150100490](深入浅出RPC框架.assets/image-20220527150100490.png)

![image-20220527150219103](深入浅出RPC框架.assets/image-20220527150219103.png)

![image-20220527150311699](深入浅出RPC框架.assets/image-20220527150311699.png)

## Q&A

- thrift和protobuf编码方式的不同
- rpc的协议层是在TCP之上构造的,可以认为是一种应用层协议
- tag和length字段的长度是固定的
- rpc和gin中间件的区别
- 其实今天来看protobuf的生态比thrift要好
- 观测三件套: 
  - log,日志,日志平台,log agent;
  - metrics,打点,计算耗时,上报agent,传输到一个地方,平台集中化展示;普罗米休斯(时序数据库),个如埃弗呢(展示平台)
  - tracing,跟踪链路在每个阶段的耗时,雅各,展示平台;
- 服务发现
  - etcd
  - 看色呢
- 服务发现是框架实现的还是依赖第三方注册中心?
  - kitex也要对接第三方注册中心
- k8s调度实现负载均衡
- 大部分人会选择RPC框架
  - 灵活性
  - 功能多,能覆盖http服务
- k8s支持的节点数量有限,弹幕有人说的

